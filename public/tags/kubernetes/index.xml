<rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0">
    <channel>
        <title>Kubernetes - Tag - LexusLee&#39;s blog</title>
        <link>https://example.com/tags/kubernetes/</link>
        <description>Kubernetes - Tag - LexusLee&#39;s blog</description>
        <generator>Hugo -- gohugo.io</generator><language>en</language><managingEditor>lexuscyborg103@gmail.com (LexusLee)</managingEditor>
            <webMaster>lexuscyborg103@gmail.com (LexusLee)</webMaster><copyright>This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.</copyright><lastBuildDate>Sun, 13 Feb 2022 21:55:54 &#43;0800</lastBuildDate><atom:link href="https://example.com/tags/kubernetes/" rel="self" type="application/rss+xml" /><item>
    <title>è®°ä¸€æ¬¡ k8s apiserver watch hang é—®é¢˜æ’æŸ¥</title>
    <link>https://example.com/k8s-api-watch-hang-dignosis/</link>
    <pubDate>Sun, 13 Feb 2022 21:55:54 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://example.com/k8s-api-watch-hang-dignosis/</guid>
    <description><![CDATA[Lexus Lee è®°ä¸€æ¬¡ k8s apiserver watch hang é—®é¢˜æ’æŸ¥ é—®é¢˜èƒŒæ™¯ æ³¨ğŸ“¢: æœ¬æ–‡ä¸­æ¶‰åŠ apiserver åœ°å€å’Œ ingressgateway åœ°å€, ä¸ºè„±æ•å¤„ç†, å°†ä¼šåšé©¬èµ›å…‹å¤„ç†ï¼ï¼ï¼
ä¼ ç»Ÿçš„ kubernetes apiserver è¯·æ±‚è®¿é—®é“¾è·¯ä¸ºå®¢æˆ·ç«¯ç›´è¿ apiserverï¼Œä¸ºäº†åš apiserver é«˜å¯ç”¨ï¼Œé€šå¸¸æˆ‘ä»¬ä¼šç»™ apiserver å‰ç«¯å†å¥—ä¸€å±‚4å±‚æˆ–7å±‚ä»£ç†åšå¤šä¸ª apiserver å®ä¾‹çš„è´Ÿè½½å‡è¡¡ã€‚
åœ¨æˆ‘ä»¬çš„åœºæ™¯ä¸‹ï¼Œä½¿ç”¨äº† istio çš„ ingressgateway ä½œä¸º client -&gt; apiserver è¿™æ¡é“¾è·¯ä¸­çš„7å±‚ä»£ç†ã€‚é“¾è·¯å˜æˆäº† client -&gt; ingressgateway -&gt; apiserver ï¼Œgateway æš´éœ² 80 ç«¯å£ä¾›å®¢æˆ·ç«¯è®¿é—®, åŒæ—¶é€šè¿‡ istio virtualService + destinationRule è§„åˆ™é…ç½® gateway èƒ½é€šè¿‡åŸŸåè®¿é—®åˆ° apiserver 6443 ç«¯å£ï¼Œä»è€Œå®ç°æµé‡è·¯ç”±ã€‚
å…·ä½“é“¾è·¯å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ
åœ¨è¿™æ ·çš„é“¾è·¯ä¸‹ï¼Œæˆ‘ä»¬é‡åˆ°äº†å¦‚ä¸‹é—®é¢˜ï¼Œ
åœ¨ k8s apiserver 1.18 ç‰ˆæœ¬çš„é›†ç¾¤åœ¨æ»šåŠ¨é‡å¯è¿‡å‡ºç°éƒ¨åˆ†ç»„ä»¶æ— æ³• watch åˆ°äº‹ä»¶çš„æƒ…å†µï¼Œå®¢æˆ·ç«¯ watch è¯·æ±‚å¶å‘ 503ã€‚éœ€è¦é‡å¯ç»„ä»¶ï¼Œé‡å»º watch è¿æ¥æ‰èƒ½æ¢å¤ã€‚]]></description>
</item><item>
    <title>Kube-scheduler è°ƒåº¦æ¨¡å‹ä¸ç¾å›¢æœ¬åœ°åŒ–æ”¹é€ </title>
    <link>https://example.com/kubernetes-scheduler-modified-in-meituan/</link>
    <pubDate>Sat, 09 Oct 2021 09:57:53 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://example.com/kubernetes-scheduler-modified-in-meituan/</guid>
    <description><![CDATA[èƒŒæ™¯ ä»Šå¤©ä¸»è¦åˆ†äº«ä¸‹æˆ‘åœ¨ç¾å›¢ Hulk å›¢é˜Ÿè°ƒåº¦ç³»ç»Ÿç»„æœŸé—´å­¦ä¹ åˆ°çš„ k8s scheduler è°ƒåº¦æ¨¡å‹åŠç¾å›¢å¯¹äºè°ƒåº¦å™¨ç›¸å…³æ”¹é€ 
Hulk å›¢é˜Ÿä»‹ç» Hulk æ˜¯ç¾å›¢è´Ÿè´£å®¹å™¨äº‘å¹³å°çš„å›¢é˜Ÿ, æˆ‘æ‰€åœ¨çš„ç»„æ˜¯è°ƒåº¦ç³»ç»Ÿç»„ä¸‹é¢çš„ k8s å°ç»„. ä¸»è¦è´Ÿè´£æ‰€æœ‰ k8s ç›¸å…³ç»„ä»¶å¼€å‘ç»´æŠ¤.
Kube-scheduler è°ƒåº¦æ¨¡å‹ä»‹ç» (æœ¬æ¬¡ä»‹ç»åŸºäº k8s 1.16 ç‰ˆæœ¬)
pod æ˜¯ k8s å·¥ä½œè´Ÿè½½çš„æœ€å°å®ä½“ï¼Œä¹Ÿæ˜¯ scheduler è°ƒåº¦çš„ä¸»è¦å¯¹è±¡ã€‚
k8s è°ƒåº¦å™¨æ‰€åšçš„å·¥ä½œï¼Œå³å°† pod ç»‘å®šåˆ°æŒ‡å®šèŠ‚ç‚¹ä¸Šï¼Œä¸º pod é€‰æ‹©åˆé€‚çš„èŠ‚ç‚¹ã€‚
Scheduler ä¼šå…ˆ watch apiserver è·å–å…¶ä¸­å¾…è°ƒåº¦çš„ pod, å³ pod.spec.nodeName å­—æ®µä¸ºç©ºçš„ pod å¯¹è±¡, é€šè¿‡è°ƒç”¨ pod informer çš„ handler å¹¶å°†è¯¥ pod åŠ å…¥è°ƒåº¦é˜Ÿåˆ—ä¸­ã€‚
é»˜è®¤æƒ…å†µä¸‹, k8s è°ƒåº¦é˜Ÿåˆ—æ˜¯ä¸€ä¸ª PriorityQueue, å¹¶ä¸”å½“æŸäº›é›†ç¾¤ä¿¡æ¯å‘ç”Ÿæ”¹å˜æ—¶, è°ƒåº¦å™¨ä¼šå¯¹è°ƒåº¦é˜Ÿåˆ—çš„å†…å®¹è¿›è¡Œä¸€äº›ç‰¹æ®Šæ“ä½œ. åœ¨è¿™å„¿ä¸è®ºè¿°.
ä¸€æ¬¡è°ƒåº¦è¿‡ç¨‹åœ¨åˆ¤æ–­ä¸€ä¸ª Nodeæ˜¯å¦å¯ä½œä¸ºç›®æ ‡æœºå™¨æ—¶ï¼Œä¸»è¦åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š
 Predicates é¢„é€‰é˜¶æ®µï¼šç¡¬æ€§æ¡ä»¶ï¼Œè¿‡æ»¤æ‰ä¸æ»¡è¶³æ¡ä»¶çš„èŠ‚ç‚¹ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º Predicatesã€‚è¿™æ˜¯å›ºå®šå…ˆåé¡ºåºçš„ä¸€ç³»åˆ—è¿‡æ»¤æ¡ä»¶ï¼Œä»»ä½•ä¸€ä¸ª Predicate ä¸ç¬¦åˆåˆ™æ”¾å¼ƒè¯¥ Nodeã€‚ Prioritites ä¼˜é€‰é˜¶æ®µï¼šè½¯æ€§æ¡ä»¶ï¼Œå¯¹é€šè¿‡çš„èŠ‚ç‚¹æŒ‰ç…§ä¼˜å…ˆçº§æ’åºï¼Œç§°ä¹‹ä¸º Prioritiesã€‚æ¯ä¸€ä¸ª Priority éƒ½æ˜¯ä¸€ä¸ªå½±å“å› ç´ ï¼Œéƒ½æœ‰ä¸€å®šçš„æƒé‡ã€‚ Select é€‰å®šé˜¶æ®µï¼šä»ä¼˜é€‰åˆ—è¡¨ä¸­é€‰æ‹©ä¼˜å…ˆçº§æœ€é«˜çš„èŠ‚ç‚¹ï¼Œç§°ä¸º Selectã€‚é€‰æ‹©çš„ Node å³ä¸ºæœ€ç»ˆéƒ¨ç½² Pod çš„æœºå™¨ã€‚  é¢„é€‰é˜¶æ®µ Scheduler èµ· n ä¸ª goroutine å¹¶å‘å¯¹æ•´ä¸ªé›†ç¾¤çš„æ‰€æœ‰ nodes è¿›è¡Œ predicates ä¸²è¡Œè¿ç®—è¿‡æ»¤è§„åˆ™ï¼Œç›´åˆ°æœ€ç»ˆè¿‡æ»¤å‡ºç¬¦åˆæ¡ä»¶çš„ nodes åˆ—è¡¨]]></description>
</item><item>
    <title>äº‘åŸç”Ÿä¸‹å‘å¸ƒå¹³å°å»ºè®¾æ€è€ƒ</title>
    <link>https://example.com/talk-about-cloud-based-release-platform/</link>
    <pubDate>Sat, 02 Oct 2021 11:04:16 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://example.com/talk-about-cloud-based-release-platform/</guid>
    <description><![CDATA[<div style="text-align: right;">Lexus Lee</div>
<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>
<p>ä»è¿‡å»å‡ ä¸ªæœˆ, æˆ‘çš„å·¥ä½œç²¾åŠ›ä¸»è¦é›†ä¸­åœ¨ä¼ä¸šçº§å‘å¸ƒå¹³å°çš„å»ºè®¾ä¸Š. åŒæ—¶ä¹Ÿèšç„¦åœ¨å®¹å™¨äº‘ <strong>PaaS</strong> å±‚å»ºè®¾ã€‚</p>
<p>åœ¨å½“ä¸‹äº‘åŸç”Ÿæ—¶ä»£, å‘å¸ƒå¹³å°é€šå¸¸èµ·åˆ°ä¸€ä¸ªè”ç»“ PaaS å’Œ IaaS çš„ä½œç”¨. é€šè¿‡åœ¨ <strong>PaaS</strong> å±‚æŠ½è±¡ï¼Œå°† IaaS å±‚åŸºå»ºç»†èŠ‚å±è”½ï¼ŒåŒæ—¶é€šè¿‡ api å’Œå„ä¸ªæœåŠ¡å¹³å°(CI/CD æœåŠ¡, ç›‘æ§å‘Šè­¦æœåŠ¡, ç½‘å…³æœåŠ¡, å·¥å•ç³»ç»Ÿ, æœåŠ¡æ²»ç†ç³»ç»Ÿç­‰) äº¤äº’, åœ¨äº‘å¹³å°æä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„å¿«æ·å…¥å£ï¼Œä»é€»è¾‘ä¸Šè¿›è¡Œæ±‡èšï¼Œä¾¿äºå¼€å‘è€…è¿›è¡Œ<strong>ä¸€ç«™å¼</strong>åº”ç”¨å‘å¸ƒã€æœåŠ¡ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€æœåŠ¡æ²»ç†ã€æœåŠ¡è¿ç»´ç­‰æ“ä½œ.</p>]]></description>
</item><item>
    <title>åŸºäºæœåŠ¡ç”»åƒçš„å‚ç›´ä¼¸ç¼©ç³»ç»Ÿå»ºè®¾æ€è€ƒ</title>
    <link>https://example.com/service-portrait-vpa-design/</link>
    <pubDate>Tue, 28 Sep 2021 19:51:32 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://example.com/service-portrait-vpa-design/</guid>
    <description><![CDATA[<div style="text-align: right;">Lexus Lee</div>
<h2 id="èƒŒæ™¯">èƒŒæ™¯</h2>
<p>è¿‘æœŸå…¬å¸å¼€å§‹åšæˆæœ¬æ²»ç†, é™æœ¬å¢æ•ˆ. é€šè¿‡è§‚å¯Ÿä»¥å¾€å„ä¸šåŠ¡çº¿çš„èµ„æºè§„æ ¼é…ç½®, ä¸éš¾å‘ç°å­˜åœ¨å¤§é‡æœåŠ¡èµ„æºè¶…é…æƒ…å†µ. å³æœåŠ¡å®é™…èµ„æºå¼€é”€è¿œå°äºå…¶å£°æ˜çš„èµ„æºå¼€é”€. è€Œè¿™éƒ¨åˆ†çš„èµ„æºè¶…é…ç›´æ¥å¯¼è‡´äº†é›†ç¾¤çš„èµ„æºä½¿ç”¨ç‡è¾ƒä½. é€šå¸¸å½¢å¦‚ä¸‹å›¾</p>]]></description>
</item><item>
    <title>Talk about Containerd</title>
    <link>https://example.com/talk-about-containerd/</link>
    <pubDate>Sat, 10 Apr 2021 15:04:09 &#43;0800</pubDate>
    <author>Author</author>
    <guid>https://example.com/talk-about-containerd/</guid>
    <description><![CDATA[èƒŒæ™¯ æœ€è¿‘çœ‹ä¸€äº›ç¤¾åŒº issue ä¸­æ­£å¥½æ¥è§¦åˆ° containerd æºç , æ—©å¹´å¤§å®¶åŸºæœ¬éƒ½ä½¿ç”¨ docker/podman è¿™ç±»å®¹å™¨ä¸Šå±‚åŒ…è£…, åŒ…æ‹¬æˆ‘ä¹Ÿæ˜¯, æ•…å¯¹çœŸæ­£å®¹å™¨è¿è¡Œæ—¶çš„ç»“æ„éƒ¨åˆ†äº†è§£å¾—ä¸å¤Ÿæ·±å…¥, æœ€è¿‘ k8s ç¤¾åŒºåœ¨ 1.21 è§„åˆ’ä¸Šè®¡åˆ’ä» kubelet ä¸­ç§»é™¤ docker-shim äº¤äº’çš„é€»è¾‘, å¤§åŠ¿ä¸Šç»„ä»¶èµ°ä¸Š containerd-shim, æ•…éœ€è¦ç€æ‰‹å¯¹å®¹å™¨è¿è¡Œæ—¶æ›´æ·±å…¥äº†è§£.
å¸¦ç€é—®é¢˜ä½œä¸ºå¼•å…¥,
å®¹å™¨åº•å±‚è¿˜æ˜¯å¯¹ Linux LXC çš„äº¤äº’, é‚£ç©¶ç«Ÿ docker daemon ä¸­æ˜¯å“ªä¸ªç»„ä»¶æ¥å®Œæˆè¿™ä¸€æ­¥çš„å‘¢ï¼Ÿ
1ã€èƒŒæ™¯çŸ¥è¯† é¦–å…ˆæˆ‘ä»¬éœ€è¦äº†è§£ Docker Daemon ç”Ÿäº§å‡ºå®¹å™¨çš„è¿‡ç¨‹.
å½“å‰æ•´ä¸ª Docker è°ƒç”¨é“¾æ¶æ„å¯ä»¥ç”¨ä¸‹å›¾æ¥ç®€å•æ¦‚æ‹¬
ä» Docker 1.11 ä¹‹åï¼ŒDocker Daemon è¢«åˆ†æˆäº†å¤šä¸ªæ¨¡å—ä»¥é€‚åº” OCI æ ‡å‡†ã€‚æ‹†åˆ†ä¹‹åï¼Œç»“æ„åˆ†æˆäº†ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š
16å¹´12æœˆ Dockerå…¬å¸å®£å¸ƒå°† containerd ä»Docker Engineä¸­åˆ†ç¦»ï¼Œå¹¶æèµ åˆ°å¼€æºç¤¾åŒºç‹¬ç«‹å‘å±•å’Œè¿è¥ã€‚
ä¸€ä¸ªå·¥ä¸šæ ‡å‡†çš„å®¹å™¨è¿è¡Œæ—¶ï¼Œæ³¨é‡ç®€å•ã€ å¥å£®æ€§ã€å¯ç§»æ¤æ€§
Dockeræœ¬èº«å…¶å®å·²ç»è¢«å‰¥ç¦»å¹²å‡€äº†ï¼Œåªå‰©ä¸‹ Docker è‡ªèº«ä½œä¸º cli çš„ä¸€äº›ç‰¹è‰²åŠŸèƒ½äº†ï¼ŒçœŸæ­£å®¹å™¨çš„ç®¡æ§éƒ½åœ¨ containerd é‡Œå®ç°ã€‚
åœ¨ 17 å¹´ dockeré‡å‘½åä¸ºmoby, ä»å‘½åä¸Šé€æ¸è„±ç¦»å’Œ container çš„å…³ç³», è€Œ Moby æ›´åƒæ˜¯ä¸€ä¸ªâ€œä¹é«˜ç§¯æœ¨â€ï¼Œå®ƒåŒ…å«äº†å®¹å™¨åŒ–çš„ç»„ä»¶åº“ åº•å±‚çš„æ„å»ºã€æ—¥å¿—å¤„ç†ã€å·ç®¡ç†ã€ç½‘ç»œã€é•œåƒç®¡ç†ã€containerdã€SwarmKitç­‰æ¨¡å—, æ˜¯ä¸ªå¤§æ‚çƒ©.]]></description>
</item><item>
    <title>è¯‘ã€ŠAutopilot: workload autoscaling at Googleã€‹</title>
    <link>https://example.com/google-autopilot-scaling/</link>
    <pubDate>Sun, 10 Jan 2021 13:10:46 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://example.com/google-autopilot-scaling/</guid>
    <description><![CDATA[æ‘˜è¦ åŸæ–‡é“¾æ¥ï¼šhttps://dl.acm.org/doi/pdf/10.1145/3342195.3387524
åœ¨è®¸å¤šå…¬å…±å’Œç§æœ‰äº‘ç³»ç»Ÿä¸­ï¼Œç”¨æˆ·éœ€è¦æŒ‡å®šèµ„æºé‡ï¼ˆCPUå†…æ ¸å’ŒRAMï¼‰çš„é™åˆ¶ä»¥ä¸ºå…¶å·¥ä½œè´Ÿè·æä¾›èµ„æºã€‚ è¶…å‡ºå…¶é™åˆ¶çš„ä½œä¸šå¯èƒ½ä¼šå—åˆ°é™åˆ¶æˆ–ç»ˆæ­¢ï¼Œä»è€Œå¯¼è‡´æœ€ç»ˆç”¨æˆ·è¯·æ±‚çš„å»¶è¿Ÿæˆ–ä¸¢å¼ƒï¼Œå› æ­¤äººå·¥æ“ä½œäººå‘˜é’ˆå¯¹è¿™ç§é—®é¢˜å‡ºäºè°¨æ…è€ƒè™‘ï¼Œä¼šç”³è¯·é«˜äºä»»åŠ¡è‡ªèº«éœ€è¦çš„é…ç½®ã€‚ ä»è§„æ¨¡ä¸Šè®²ï¼Œè¿™å°†å¯¼è‡´å¤§é‡çš„èµ„æºæµªè´¹ã€‚
ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒGoogleä½¿ç”¨Autopilotè‡ªåŠ¨é…ç½®èµ„æºï¼ŒåŒæ—¶è°ƒæ•´ä½œä¸šä¸­çš„å¹¶å‘ä»»åŠ¡æ•°ï¼ˆæ°´å¹³ç¼©æ”¾ï¼‰å’Œå•ä¸ªä»»åŠ¡çš„CPU /å†…å­˜é™åˆ¶ï¼ˆå‚ç›´ç¼©æ”¾ï¼‰ã€‚ Autopilotä¸äººå·¥æ“ä½œå‘˜éµå¾ªç›¸åŒçš„åŸåˆ™ï¼šAutopilotçš„ä¸»è¦ç›®æ ‡æ˜¯å‡å°‘æ¾å¼›ï¼ˆslackï¼‰ï¼ˆç”³è¯·èµ„æºå’Œå®é™…èµ„æºä½¿ç”¨ä¹‹é—´çš„å·®å¼‚ï¼‰ï¼ŒåŒæ—¶æœ€å¤§ç¨‹åº¦åœ°é™ä½å› å†…å­˜ä¸è¶³ï¼ˆOOMï¼‰é”™è¯¯æˆ– ç”±äºCPUèŠ‚æµï¼Œå…¶æ€§èƒ½ä¸‹é™ã€‚ Autopilotå°†æœºå™¨å­¦ä¹ ç®—æ³•åº”ç”¨åˆ°æœ‰å…³ä½œä¸šå…ˆå‰æ‰§è¡Œæƒ…å†µçš„å†å²æ•°æ®ä¸Šï¼Œå†åŠ ä¸Šä¸€ç»„ç»è¿‡å¾®è°ƒçš„å¯å‘å¼æ–¹æ³•æ¥å®ç°è¿™ä¸€ç›®æ ‡ã€‚ åœ¨å®è·µä¸­ï¼ŒAutopilotå·¥ä½œåªæœ‰23ï¼…çš„æ¾å¼›ï¼ˆslackï¼‰ï¼Œè€Œæ‰‹åŠ¨ç®¡ç†å·¥ä½œåªæœ‰46ï¼…çš„æ¾å¼›ï¼ˆslackï¼‰ã€‚ æ­¤å¤–ï¼ŒAutopilotå°†å—OOMä¸¥é‡å½±å“çš„å·¥ä½œæ•°é‡å‡å°‘äº†10å€ã€‚
å°½ç®¡æœ‰å…¶ä¼˜ç‚¹ï¼Œè¦ç¡®ä¿Autopilotè¢«å¹¿æ³›é‡‡ç”¨ä»éœ€ä»˜å‡ºå·¨å¤§çš„åŠªåŠ›ï¼ŒåŒ…æ‹¬ä½¿å°šæœªåŠ å…¥çš„å®¢æˆ·å®¹æ˜“çœ‹åˆ°æ½œåœ¨çš„å»ºè®®ï¼Œè‡ªåŠ¨è¿ç§»æŸäº›ç±»åˆ«çš„ä»»åŠ¡ä»¥åŠå¢åŠ å¯¹è‡ªå®šä¹‰æ¨èå™¨çš„æ”¯æŒã€‚ åœ¨æ’°å†™æœ¬æ–‡æ—¶ï¼ŒAutopilotä»»åŠ¡å Googleèµ„æºä½¿ç”¨çš„48ï¼…ä»¥ä¸Šã€‚
ACMå‚è€ƒæ ¼å¼ï¼š
Krzysztof Rzadcaï¼ŒPawel Findeisenï¼ŒJacek Swiderskiï¼ŒPrzemyslaw Zychï¼ŒPrzemyslaw Broniekï¼ŒJarek Kusmierekï¼ŒPawel Nowakï¼ŒBeata Strackï¼ŒPiotr Witusowskiï¼ŒSteven Handå’ŒJohn Wilkesã€‚ 2020å¹´ã€‚
Autopilotï¼šGoogleçš„å·¥ä½œè´Ÿè½½è‡ªåŠ¨ç¼©æ”¾ã€‚ åœ¨ç¬¬åäº”æ¬§æ´²2020å¹´4æœˆ27æ—¥è‡³30æ—¥ï¼Œè®¡ç®—æœºç³»ç»Ÿä¼šè®®ï¼ˆEuroSys'20ï¼‰ï¼Œå¸Œè…Šä¼Šæ‹‰å…‹åˆ©ç¿ã€‚ ACMï¼Œç¾å›½çº½çº¦ï¼Œçº½çº¦ï¼Œå…±16é¡µã€‚ https://doi. org/10.1145/3342195.3387524
1 ä»‹ç» è®¸å¤šç±»å‹çš„å…¬å…±äº‘å’Œç§æœ‰äº‘ç³»ç»Ÿè¦æ±‚å…¶ç”¨æˆ·å£°æ˜åœ¨æ‰§è¡ŒæœŸé—´å…¶å·¥ä½œè´Ÿè½½å°†éœ€è¦å¤šå°‘ä¸ªå®ä¾‹ä»¥åŠæ¯ä¸ªå®ä¾‹æ‰€éœ€çš„èµ„æºï¼šåœ¨å…¬å…±äº‘å¹³å°ä¸­ï¼Œç”¨æˆ·éœ€è¦é€‰æ‹©ä»–ä»¬éœ€è¦ç§Ÿç”¨è™šæ‹Ÿæœºï¼ˆVMï¼‰çš„ç±»å‹å’Œæ•°é‡ï¼› åœ¨Kubernetesé›†ç¾¤ä¸­ï¼Œç”¨æˆ·å¯ä»¥è®¾ç½®Podå‰¯æœ¬çš„æ•°é‡å’Œå•ä¸ªPodçš„èµ„æºé™åˆ¶; åœ¨Googleä¸­ï¼Œæˆ‘ä»¬è¦æ±‚ç”¨æˆ·æŒ‡å®šæ‰€éœ€çš„å®¹å™¨æ•°é‡ä»¥åŠæ¯ä¸ªå®¹å™¨çš„èµ„æºé™åˆ¶ã€‚ è¿™äº›é™åˆ¶ä½¿äº‘åŸºç¡€æ¶æ„èƒ½å¤Ÿæä¾›è¶³å¤Ÿçš„æ€§èƒ½éš”ç¦»ï¼Œä»è€Œä½¿äº‘è®¡ç®—æˆä¸ºå¯èƒ½ã€‚
ä½†æ˜¯é™åˆ¶ï¼ˆä¸»è¦æ˜¯ï¼‰å¯¹ç”¨æˆ·é€ æˆäº†éº»çƒ¦ã€‚ å¾ˆéš¾ä¼°è®¡ä¸€ä¸ªä½œä¸šéœ€è¦å¤šå°‘èµ„æºæ‰èƒ½æœ€ä½³è¿è¡Œï¼šCPUåŠŸç‡ï¼Œå†…å­˜å’ŒåŒæ—¶è¿è¡Œçš„å‰¯æœ¬æ•°çš„æ­£ç¡®ç»„åˆã€‚ è´Ÿè½½æµ‹è¯•å¯ä»¥å¸®åŠ©æ‰¾åˆ°åˆå§‹ä¼°è®¡å€¼ï¼Œä½†æ˜¯éšç€èµ„æºéœ€æ±‚éšæ—¶é—´å˜åŒ–ï¼Œè¿™äº›å»ºè®®å°†è¿‡æ—¶ï¼Œå› ä¸ºè®¸å¤šæœ€ç»ˆç”¨æˆ·æœåŠ¡å·¥ä½œå…·æœ‰æ¯æ—¥æˆ–æ¯å‘¨çš„è´Ÿè½½æ¨¡å¼ï¼Œå¹¶ä¸”éšç€æœåŠ¡å˜å¾—è¶Šæ¥è¶Šæµè¡Œï¼Œæµé‡åœ¨æ›´é•¿çš„æ—¶é—´å†…å‘ç”Ÿå˜åŒ– ã€‚ æœ€åï¼Œå¤„ç†ç»™å®šè´Ÿè½½æ‰€éœ€çš„èµ„æºä¼šéšç€åŸºç¡€è½¯ä»¶æˆ–ç¡¬ä»¶å †æ ˆçš„æ–°åŠŸèƒ½ï¼Œä¼˜åŒ–å’Œæ›´æ–°è€Œå˜åŒ–ã€‚å¦‚æœCPUå®¹é‡ä¸è¶³ï¼Œè¶…å‡ºè¯·æ±‚çš„èµ„æºå¯èƒ½ä¼šå¯¼è‡´æ€§èƒ½ä¸‹é™ï¼Œæˆ–è€…å¯¼è‡´ä»»åŠ¡è¢«æ€æ­» å†…å­˜ä¸è¶³ï¼ˆOOMï¼‰ã€‚ éƒ½ä¸æ˜¯å¥½äº‹ã€‚
ä»è°ƒç ”ç»“æœçœ‹ï¼Œç†æ€§çš„ç”¨æˆ·å°†æ•…æ„é«˜ä¼°å…¶å·¥ä½œæ‰€éœ€çš„èµ„æºï¼Œä»è€Œå¯¼è‡´å¯¹ç‰©ç†èµ„æºçš„ä¸è‰¯åˆ©ç”¨ã€‚ ä¸€é¡¹åˆ†æ[26]å¯¹åœ¨ä¸€ä¸ªGoogleé›†ç¾¤[27]ä¸Šæ‰§è¡Œçš„ä¸ºæœŸä¸€ä¸ªæœˆçš„ä½œä¸šè·Ÿè¸ªæ˜¾ç¤ºï¼Œå¹³å‡å†…å­˜åˆ©ç”¨ç‡ä¸º50ï¼…ï¼› å¯¹é˜¿é‡Œå·´å·´YARNé›†ç¾¤çš„å¦ä¸€é¡¹åˆ†æ[23]æ˜¾ç¤ºä»»åŠ¡çš„å³°å€¼å†…å­˜åˆ©ç”¨ç‡ä»æœªè¶…è¿‡80ï¼…ã€‚
é’ˆå¯¹é…ç½®èµ„æºçš„å›°éš¾ï¼Œä¸€ç§å¸¸è§çš„æ¨¡å¼æ˜¯é‡‡ç”¨æ°´å¹³è‡ªåŠ¨ç¼©æ”¾å™¨ï¼Œè¯¥ç¼©æ”¾å™¨é€šè¿‡ç›‘æ§ç»ˆç«¯ç”¨æˆ·æµé‡æˆ–å¹³å‡CPUåˆ©ç”¨ç‡çš„å˜åŒ–æ·»åŠ æˆ–åˆ é™¤å‰¯æœ¬æ¥ç¼©æ”¾ä»»åŠ¡ã€‚ æ‰€æœ‰ä¸»è¦çš„äº‘æä¾›å•†ï¼ˆAWSï¼ŒAzureå’ŒGCPï¼‰éƒ½æä¾›æ°´å¹³è‡ªåŠ¨æ‰©å±•åŠŸèƒ½ï¼› å®ƒåœ¨æŸäº›äº‘ä¸­é—´ä»¶ï¼ˆå¦‚Kubernetesï¼‰ä¸­ä¹Ÿå¯ç”¨ã€‚ è¾ƒä¸å¸¸è§çš„æ¨¡å¼æ˜¯ä½¿ç”¨å‚ç›´è‡ªåŠ¨ç¼©æ”¾æ¥è°ƒæ•´æ¯ä¸ªå‰¯æœ¬å¯ç”¨çš„èµ„æºé‡ã€‚ ä¸¤ç§æŠ€æœ¯ä¹Ÿå¯ä»¥ç»„åˆã€‚
Autopilotæ˜¯Googleåœ¨å…¶å†…éƒ¨äº‘ä¸Šä½¿ç”¨çš„ä¸»è¦è‡ªåŠ¨ç¼©æ”¾å™¨ã€‚ å®ƒæä¾›æ°´å¹³å’Œå‚ç›´è‡ªåŠ¨ç¼©æ”¾ã€‚ æœ¬æ–‡é‡ç‚¹ä»‹ç»Autopilotçš„å†…å­˜å‚ç›´æ‰©å±•ï¼Œå› ä¸ºè¿™ç§æƒ…å†µé²œä¸ºäººçŸ¥ã€‚ è®ºæ–‡ï¼š
  æè¿°ä¸‹Autopilotï¼Œä»¥åŠå®ƒç”¨äºå‚ç›´è‡ªåŠ¨ç¼©æ”¾çš„ä¸¤ä¸ªä¸»è¦ç®—æ³•ï¼šç¬¬ä¸€ä¸ªç®—æ³•ä¾èµ–äºå†å²ç”¨é‡çš„æŒ‡æ•°å¹³æ»‘æ»‘åŠ¨çª—å£ï¼› å¦ä¸€ä¸ªæ˜¯åŸºäºä»å¼ºåŒ–å­¦ä¹ ä¸­å€Ÿç”¨çš„æ€æƒ³çš„å…ƒå­¦ä¹ ï¼Œè¯¥ç®—æ³•è¿è¡Œæ»‘åŠ¨çª—å£ç®—æ³•çš„è®¸å¤šå˜ä½“ï¼Œå¹¶ä¸ºæ¯ä¸ªä»»åŠ¡é€‰æ‹©å†å²æ•°æ®è¡¨ç°æœ€ä½³çš„ç®—æ³•ã€‚ï¼ˆè¯‘æ³¨ï¼šå¼ºåŒ–å­¦ä¹ ï¼šä¾èµ–æµ·é‡çš„è®­ç»ƒï¼Œå¹¶ä¸”éœ€è¦ç²¾å‡†çš„å¥–åŠ±ã€‚æˆæœ¬è¾ƒé«˜ä¸”æ¯”è¾ƒå¤æ‚ã€‚å…ƒå­¦ä¹ ï¼šå…·å¤‡è‡ªå­¦èƒ½åŠ›ï¼Œèƒ½å¤Ÿå……åˆ†åˆ©ç”¨è¿‡å»çš„ç»éªŒæ¥æŒ‡å¯¼æœªæ¥çš„ä»»åŠ¡ã€‚è¢«è®¤ä¸ºæ˜¯å®ç°é€šç”¨äººå·¥æ™ºèƒ½çš„å…³é”®ã€‚ï¼‰
  é€šè¿‡Googleçš„å·¥ä½œè´Ÿè½½é‡‡æ ·è¯„ä¼°Autopilotç®—æ³•çš„æœ‰æ•ˆæ€§ï¼›
  è®¨è®ºä¸ºä½¿æˆ‘ä»¬çš„é›†ç¾¤å¹¿æ³›é‡‡ç”¨Autopilotè€Œé‡‡å–çš„æ­¥éª¤ã€‚
  2 é€šè¿‡Borgç®¡ç†äº‘èµ„æº Autopilotçš„ç›®æ ‡å’Œåˆ¶çº¦å› ç´ æ¥è‡ªGoogleçš„BorgåŸºç¡€æ¶æ„ï¼Œå¹¶ä¸”é’ˆå¯¹Googleçš„å·¥ä½œè´Ÿè½½è¿›è¡Œäº†è°ƒæ•´ã€‚ æˆ‘ä»¬åœ¨æ­¤å¤„æä¾›äº†ä¸¤è€…çš„ç®€è¦æ¦‚è¿°ï¼šæœ‰å…³Borgçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§[34]ï¼Œæœ‰å…³å·¥ä½œè´Ÿè½½çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§[26ã€27ã€31ã€35]ã€‚]]></description>
</item><item>
    <title>å‡çº§ k8s é›†ç¾¤ docker</title>
    <link>https://example.com/upgrade-dockerd-in-k8s/</link>
    <pubDate>Fri, 10 Jul 2020 19:10:46 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://example.com/upgrade-dockerd-in-k8s/</guid>
    <description><![CDATA[èƒŒæ™¯ æœ€è¿‘éœ€è¦ç»™ k8s é›†ç¾¤å‡çº§ docker, é¢„æœŸå‡åˆ° 19.03.x.
é‡åˆ°ä¸€äº›é—®é¢˜, è®°å½•ä¸‹
è°ƒè¯•æœŸé—´é‡åˆ°çš„é—®é¢˜: é›†ç¾¤ä¸­çš„ ingress æ˜¯ä»¥ daemonsets æ–¹å¼éƒ¨ç½², é€šè¿‡ node-selector é€‰æ‹©èŠ‚ç‚¹å®šæ­».
è€Œ kubectl drain node å¹¶ä¸ evict daemonset pods. æ•…åœ¨å‡çº§/é‡å¯ dockerd æœŸé—´ä¼šé€ æˆ ingress çŸ­æš‚ä¸å¯ç”¨. è€Œç°æœ‰çš„ lb çš„ health check ä¸èƒ½ cover è¿™ä¸€ç‚¹, ä»ä¼šæœ‰æµé‡æ‰“å…¥.ä¼šå¯¼è‡´å‡çº§æœŸé—´ ingress æµé‡é»‘æ´é—®é¢˜.
å¹¶ä¸” dockerd æ‹‰èµ·æ¥å, æœ‰äº› daemonsets ç”±äº ingress è‡ªèº« livenessProbe ç­‰åŸå› åœ¨ dockerd å‡çº§æœŸé—´æŒç»­ crashLoopbackoff äº†, ä¸€ä¸ªåŸå› æ˜¯ä»ç„¶ mount ä¸€ä»½æ—§çš„ docker overlay. åœ¨ delete pod é‡å¯åæ¢å¤. æ•…éœ€è¦ä¸€ä¸ªæ‰‹æ®µåœ¨å‡çº§åé‡å¯ ingress pods.
Ref https://github.com/kubernetes/kubernetes/issues/75482#issuecomment-511476698]]></description>
</item><item>
    <title>Talk about Kubernetes cronJob controller</title>
    <link>https://example.com/talk-about-k8s-cronjob/</link>
    <pubDate>Sat, 14 Dec 2019 13:57:32 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://example.com/talk-about-k8s-cronjob/</guid>
    <description><![CDATA[èƒŒæ™¯ ä¹‹å‰ä¸€æ®µæ—¶é—´æ­£å¥½æ¥è§¦åˆ° kubernetes cronjob, åœ¨æ¥å…¥æ—¶é‡ä¸Šäº†åœ¨ä¸€å®šé‡çº§ä¸‹ cronjob schedule delay çš„é—®é¢˜, æ•…å¼€å§‹è¯»äº†ä¸‹ä»£ç , å‘ç°äº†ä¸€äº›é—®é¢˜å¹¶è¯•ç€è°ƒä¼˜äº†ä¸‹
å­˜åœ¨çš„é—®é¢˜ æŒ‰ç”Ÿäº§ç¯å¢ƒå®é™…æµ‹è¯•æ¥çœ‹çº¦ 250-375 ä¸ª */1 * * * * æ¯åˆ†é’Ÿ interval çš„ cronjob å°±ä¼šäº§ç”Ÿ delay, cronjob å’Œ controller manager æ²¡æœ‰å¼‚å¸¸ event ä½†æ–°äº§ç”Ÿçš„ job å‡ºç°äº†å»¶è¿Ÿ, ç”±äºæˆ‘ä»¬è®¾ç½®äº† startingDeadlineSeconds æ•…ç´¯åŠ èµ·æ¥çš„ delay æœ€ç»ˆå¯¼è‡´äº† cron ä»»åŠ¡ä¸¥é‡æ»å
ä»£ç è§£è¯» å‡ºäºåˆ†æä¸Šè¿°é—®é¢˜çš„ç›®çš„, è¯»äº†ä¸‹ cronjob controller çš„ä»£ç , ä»£ç é‡ä¸å¤š, å¯èƒ½ç”±äºæ²¡ä¸Š GA çš„åŸå› , æ•´ä¸ª controllor ä»£ç çš„è®¾è®¡ä¹Ÿæ¯”è¾ƒè¿‡ç¨‹å¼, ä¸ä¼šåƒå…¶ä»–ç»„ä»¶ç”¨åˆ°ä¸€äº›æ¯”å¦‚ Informer, refractorä¹‹ç±»çš„ç»„ä»¶è¯»èµ·æ¥ç›¸å¯¹æ™¦æ¶©
ä¸‹é¢å¼€å§‹è§£è¯»ä¸‹ release1.17 åˆ†æ”¯çš„ k8s cronjob controller ä»£ç 
 Controller struct  1 2 3 4 5 6 7  type Controller struct { kubeClient clientset.]]></description>
</item><item>
    <title>è®°ä¸€æ¬¡å‡çº§ kube-proxy ipvs å¼•å‘çš„çº¿ä¸Šæ•…éšœ</title>
    <link>https://example.com/kubeproxy-ipvs-accident/</link>
    <pubDate>Mon, 29 Apr 2019 19:10:46 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://example.com/kubeproxy-ipvs-accident/</guid>
    <description><![CDATA[èƒŒæ™¯ æœ€è¿‘åœ¨å‡çº§é›†ç¾¤çš„ kube-prxoy å¹¶å¼€å¯ ipvs mode, å¼•å‘äº†ä¸€äº›çº¿ä¸Šæ•…éšœ
æ›¿æ¢åŸå›  ç”±äºè±†ç“£çš„é›†ç¾¤ä½¿ç”¨ calico + kube-proxy iptables mode + puppet iptable è„šæœ¬ç®¡ç†
ä¸‰ä¸ªç»„ä»¶å…±åŒæ“ä½œåŒä¸€ä»½ iptables, å®¹æ˜“å‡ºç° race condition é—®é¢˜, å¹¶ä¸”è¿˜ä¼šäº’ç›¸æŠ¢å  iptables é”, æ˜¯ä¸ª Mutex unsafe çš„æ“ä½œ, ä¸æ˜“äºç»´æŠ¤.
æ•…æ‰“ç®—å°½é‡å‡å°‘æ“ä½œ iptables çš„éƒ¨åˆ†, æ›¿æ¢æˆ ipvs
äº‹æ•…å›æº¯ 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24  @400000005cbea9a81eaf9164 W0423 13:58:54.514773 14016 server.go:195] WARNING: all flags other than --config, --write-config-to, and --cleanup are deprecated.]]></description>
</item><item>
    <title>æµ…è°ˆ k8s service&amp;kube-proxy</title>
    <link>https://example.com/k8s-service-endpoints/</link>
    <pubDate>Fri, 14 Sep 2018 19:10:46 &#43;0000</pubDate>
    <author>Author</author>
    <guid>https://example.com/k8s-service-endpoints/</guid>
    <description><![CDATA[<div style="text-align: right;">Lexus Lee</div>
<h3 id="èƒŒæ™¯">èƒŒæ™¯</h3>
<p>æœ€å¼€å§‹å¬åˆ°åŒäº‹ k8s åˆ†äº«æ—¶æ¯”è¾ƒå›°æƒ‘æˆ‘çš„ä¸€ä¸ªé—®é¢˜æ˜¯ k8s æ€ä¹ˆå®ç°ä¸€ä¸ªç§æœ‰ ip(è™šæ‹Ÿ ipï¼Œä»¥ä¸‹ç®€ç§° vip)åˆ°å¦ä¸€ä¸ªç§æœ‰ipæ”¶å‘åŒ…çš„ã€‚</p>
<p>ä¸è¿‡å…¶å®æˆ‘æƒ³çŸ¥é“çš„åº”è¯¥æ˜¯ k8s é€šä¿¡æœºåˆ¶ï¼Œå®ƒæ˜¯æ€ä¹ˆå®ç°æœåŠ¡å‘ç°çš„ï¼Œæ–°å»ºçš„ pod æ˜¯æ€ä¹ˆæ„ŸçŸ¥åˆ°çš„ï¼Œä¸‡ä¸€æœ‰äº› pod èŠ‚ç‚¹å˜æ›´ vip å˜äº† k8s æ˜¯å¦‚ä½•æ„ŸçŸ¥çš„ã€‚</p>
<p>åŸºäºè¿™ä¸ªé—®é¢˜ï¼Œåšä¸€ä¸‹å…³äº k8s service&amp;kube-proxy çš„åˆ†äº«ã€‚</p>]]></description>
</item></channel>
</rss>
